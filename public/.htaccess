# Enable rewrite engine
RewriteEngine On

# Serve static files from _next directory
RewriteCond %{REQUEST_URI} ^/_next/static
RewriteRule ^_next/static/(.*)$ /_next/static/$1 [L]

# Serve static files from images directory
RewriteCond %{REQUEST_URI} ^/images/
RewriteRule ^images/(.*)$ /images/$1 [L]

# Serve other static files (favicon, etc.)
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# Ensure index.html is served for root and missing files
DirectoryIndex index.html

# Handle client-side routing - redirect all requests to index.html
# But exclude README.md and other markdown files from being served
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/README\.md$ [NC]
RewriteCond %{REQUEST_URI} !\.md$ [NC]
RewriteRule ^ /index.html [L]

# Explicitly prevent README.md from being served at root
RewriteCond %{REQUEST_URI} ^/$ [NC]
RewriteCond %{QUERY_STRING} ^$ [NC]
RewriteRule ^$ /index.html [L,R=301]

# Set proper MIME types for JavaScript and CSS
<IfModule mod_mime.c>
  AddType application/javascript js
  AddType text/css css
</IfModule>

# Enable CORS for static assets (if needed)
<IfModule mod_headers.c>
  <FilesMatch "\.(js|css|woff|woff2|ttf|eot|svg|png|jpg|jpeg|gif|webp|ico)$">
    Header set Access-Control-Allow-Origin "*"
  </FilesMatch>
</IfModule>

# Cache static assets
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType application/javascript "access plus 1 year"
  ExpiresByType text/css "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
</IfModule>

